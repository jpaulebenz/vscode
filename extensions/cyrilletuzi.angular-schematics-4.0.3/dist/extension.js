module.exports=function(t){var e={};function o(i){if(e[i])return e[i].exports;var n=e[i]={i:i,l:!1,exports:{}};return t[i].call(n.exports,n,n.exports,o),n.l=!0,n.exports}return o.m=t,o.c=e,o.d=function(t,e,i){o.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:i})},o.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},o.t=function(t,e){if(1&e&&(t=o(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var i=Object.create(null);if(o.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var n in t)o.d(i,n,function(e){return t[e]}.bind(null,n));return i},o.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return o.d(e,"a",e),e},o.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},o.p="",o(o.s=15)}([function(t,e){t.exports=require("vscode")},function(t,e,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=o(16);e.FileSystem=i.FileSystem;var n=o(8);e.Output=n.Output;var s=o(18);e.Terminal=s.Terminals;var a=o(19);e.JsonValidator=a.JsonValidator},function(t,e){t.exports=require("path")},function(t,e,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.defaultCollectionsNames=["@angular/material","@angular/cdk","@ionic/angular-toolkit","@ngrx/schematics","@ngxs/schematics","@nativescript/schematics","@ngx-formly/schematics","primeng-schematics","@ngx-kit/collection","ngx-spec","./schematics/collection.json"],e.defaultComponentTypes=[{label:"Dialog",options:[["type","dialog"],["skipSelector","true"]],package:"@angular/material",detail:"Angular Material dialog"},{label:"Snackbar",options:[["type","snackbar"],["skipSelector","true"]],package:"@angular/material",detail:"Angular Material snackbar"},{label:"Bottomsheet",options:[["type","bottomsheet"],["skipSelector","true"]],package:"@angular/material",detail:"Angular Material bottomsheet"},{label:"Modal",options:[["type","modal"],["skipSelector","true"]],package:"@ionic/angular",detail:"Ionic modal"},{label:"Popover",options:[["type","popover"],["skipSelector","true"]],package:"@ionic/angular",detail:"Ionic popover"},{label:"Dynamic Dialog",options:[["type","dialog"],["skipSelector","true"]],package:"primeng",detail:"PrimeNG dynamic dialog"}],e.angularCollectionName="@schematics/angular",e.angularConfigFileNames=["angular.json",".angular.json","angular-cli.json",".angular-cli.json"],e.extensionName="Angular Schematics"},function(t,e,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=o(21);e.UserJourney=i.UserJourney;var n=o(7);e.formatCliCommandOptions=n.formatCliCommandOptions},function(t,e,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=o(20);e.Workspace=i.Workspace;var n=o(9);e.WorkspaceFolderConfig=n.WorkspaceFolderConfig},function(t,e,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=o(22);e.SHORTCUTS_CONFIRMATION_LABEL=i.SHORTCUTS_CONFIRMATION_LABEL,e.shortcutsConfirmationChoices=i.shortcutsConfirmationChoices;var n=o(23);e.COMPONENT_TYPE=n.COMPONENT_TYPE,e.ComponentShortcut=n.ComponentShortcut;var s=o(24);e.MODULE_TYPE=s.MODULE_TYPE,e.ModuleShortcut=s.ModuleShortcut},function(t,e,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.formatCliCommandOptions=function(t){return Array.from(t).map(([t,e])=>"true"===e?`--${t}`:Array.isArray(e)?e.map(e=>`--${t} ${e}`).join(" "):`--${t} ${e}`).join(" ")}},function(t,e,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const i=o(0),n=o(3);e.Output=class{static get channel(){return this._channel||(this._channel=i.window.createOutputChannel(n.extensionName)),this._channel}static logInfo(t){this.channel.appendLine(`[Info - ${(new Date).toLocaleTimeString()}] ${t}`)}static logWarning(t){this.channel.appendLine(`[Warning - ${(new Date).toLocaleTimeString()}] ${t}`)}static logError(t){this.channel.appendLine(`[Error - ${(new Date).toLocaleTimeString()}] ${t}`)}static showError(t){this.logError(t),i.window.showErrorMessage(t)}static dispose(){this.channel.dispose()}}},function(t,e,o){"use strict";var i=this&&this.__awaiter||function(t,e,o,i){return new(o||(o=Promise))((function(n,s){function a(t){try{c(i.next(t))}catch(t){s(t)}}function r(t){try{c(i.throw(t))}catch(t){s(t)}}function c(t){var e;t.done?n(t.value):(e=t.value,e instanceof o?e:new o((function(t){t(e)}))).then(a,r)}c((i=i.apply(t,e||[])).next())}))};Object.defineProperty(e,"__esModule",{value:!0});const n=o(0),s=o(2),a=o(3),r=o(1),c=o(4),l=o(26),u=o(28),h=o(6);e.WorkspaceFolderConfig=class{constructor(t){this.fileWatchers=[],this.uri=t.uri,this.name=t.name,this.index=t.index}init(){var t,e,o;return i(this,void 0,void 0,(function*(){this.disposeWatchers(),r.Output.logInfo("Loading Angular configuration.");const i=yield this.findAngularConfigFsPath({uri:this.uri,name:this.name,index:this.index}),c=[],d=s.dirname(i);d!==this.uri.fsPath&&r.Output.logInfo(`Your Angular project is not at the root of your "${this.name}" workspace folder. Real path: ${d}`),this.uri=n.Uri.file(d);const p=new u.AngularConfig;c.push(...yield p.init({uri:this.uri,name:this.name,index:this.index},i)),this.angularConfig=p,r.Output.logInfo("Loading global TSLint configuration.");const m=new u.TslintConfig,f=yield m.init(this.uri.fsPath);this.tslintConfig=m,r.Output.logInfo("Loading schematics configuration.");const g=new l.Collections,v=yield g.init({uri:this.uri,name:this.name,index:this.index},this.getDefaultCollections());this.collections=g;const y=new h.ComponentShortcut;yield y.init({uri:this.uri,name:this.name,index:this.index}),this.componentShortcut=y;const w=null!==(o=null===(e=null===(t=this.collections.getCollection(a.angularCollectionName))||void 0===t?void 0:t.getSchematic("module"))||void 0===e?void 0:e.hasOption("route"))&&void 0!==o&&o;r.Output.logInfo(`Lazy-loaded module type: ${w?"enabled":"disabled"}`);const C=new h.ModuleShortcut;C.init(w),this.moduleShorcut=C,this.fileWatchers.push(...c,f,...v);for(const t of this.fileWatchers)t.onDidChange(()=>{r.Output.logInfo(`Reloading "${this.name}" workspace folder configuration.`),this.init()});this.preferencesWatcher=n.workspace.onDidChangeConfiguration(()=>{r.Output.logInfo(`Reloading "${this.name}" workspace folder configuration.`),this.init()})}))}getDefaultUserCollection(){return this.angularConfig.defaultUserCollection}getDefaultCollections(){var t,e;return null!==(e=null===(t=this.angularConfig)||void 0===t?void 0:t.defaultCollections)&&void 0!==e?e:[]}getAngularProject(t){return this.angularConfig.projects.get(t)}getAngularProjects(){return this.angularConfig.projects}getComponentTypes(t){var e,o,i,n,s;const r=null!==(o=null===(e=this.getAngularProject(t))||void 0===e?void 0:e.componentShortcut.types)&&void 0!==o?o:this.componentShortcut.types,l=null!==(s=null===(n=null===(i=this.collections.getCollection(a.angularCollectionName))||void 0===i?void 0:i.getSchematic("component"))||void 0===n?void 0:n.hasOption("type"))&&void 0!==s&&s;for(const[,e]of r)if(e.options.has("type")){const o=e.options.get("type");l&&this.hasComponentSuffix(t,o)||(e.options.delete("type"),e.choice.description=c.formatCliCommandOptions(e.options))}return r}getModuleTypes(){return this.moduleShorcut.types}getSchematicsOptionDefaultValue(t,e,o){var i;const n=null===(i=this.getAngularProject(t))||void 0===i?void 0:i.getSchematicsOptionDefaultValue(e,o);return null!=n?n:this.angularConfig.getSchematicsOptionDefaultValue(e,o)}isRootAngularProject(t){return this.angularConfig.rootProjectName===t}hasComponentSuffix(t,e){var o;const i=this.getAngularProject(t);return(null!==(o=null==i?void 0:i.getComponentSuffixes().length)&&void 0!==o?o:0)>0?i.hasComponentSuffix(e):this.tslintConfig.hasComponentSuffix(e)}disposeWatchers(){var t;for(const t of this.fileWatchers)t.dispose();this.fileWatchers=[],null===(t=this.preferencesWatcher)||void 0===t||t.dispose()}findAngularConfigFsPath(t){return i(this,void 0,void 0,(function*(){const e=new n.RelativePattern(t,`**/{${a.angularConfigFileNames.join(",")}}`),o=yield n.workspace.findFiles(e,"**/node_modules/**",1);if(o.length>0)return 1===o.length?r.Output.logInfo(`Angular config file for "${this.name}" workspace folder found at: ${o[0].fsPath}`):r.Output.logInfo(`More than one Angular config file found for "${this.name}" workspace folder, keeping the first one: ${o[0].fsPath}`),o[0].fsPath;throw new Error}))}}},function(t,e,o){"use strict";var i=this&&this.__awaiter||function(t,e,o,i){return new(o||(o=Promise))((function(n,s){function a(t){try{c(i.next(t))}catch(t){s(t)}}function r(t){try{c(i.throw(t))}catch(t){s(t)}}function c(t){var e;t.done?n(t.value):(e=t.value,e instanceof o?e:new o((function(t){t(e)}))).then(a,r)}c((i=i.apply(t,e||[])).next())}))};Object.defineProperty(e,"__esModule",{value:!0});const n=o(0),s=o(2),a=o(1),r=o(11),c=o(12);e.Collection=class{constructor(t){this.schematicsChoices=[],this.schematics=new Map,this.name=t}init(t,e){return i(this,void 0,void 0,(function*(){const o=this.validateConfig(yield a.FileSystem.parseJsonFile(e));return yield this.setSchematics(t,o,e),e.includes("node_modules")?void 0:n.workspace.createFileSystemWatcher(e)}))}getName(){return this.name}getSchematicsNames(){return Array.from(this.schematics.keys()).sort()}getSchematic(t){return this.schematics.get(t)}getFullSchematicName(t){return`${this.name}:${t}`}validateConfig(t){var e,o;const i=new Map(Object.entries(null!==(o=a.JsonValidator.object(null===(e=a.JsonValidator.object(t))||void 0===e?void 0:e.schematics))&&void 0!==o?o:{}).map(([t,e])=>{const o=a.JsonValidator.object(e);return[t,{schema:a.JsonValidator.string(null==o?void 0:o.schema),description:a.JsonValidator.string(null==o?void 0:o.description),hidden:a.JsonValidator.boolean(null==o?void 0:o.hidden),private:a.JsonValidator.boolean(null==o?void 0:o.private),extends:a.JsonValidator.string(null==o?void 0:o.extends)}]}).filter(([t,e])=>!(!e.schema&&!(null==e?void 0:e.extends))||(a.Output.logWarning(`"${this.name}:${t}" schematic does not have a "schema" string property, so it is dropped.`),!1)));if(0===i.size)throw new Error(`No schematic found for "${this.name}" collection, so it is dropped.`);return{schematics:i}}setSchematics(t,e,o){return i(this,void 0,void 0,(function*(){this.schematics.clear(),this.schematicsChoices=[];const i=Array.from(e.schematics);a.Output.logInfo(`${i.length} schematic(s) detected for "${this.name}" collection: ${i.map(([t])=>t).join(", ")}`);const n=i.filter(([t,e])=>!e.hidden&&!e.private).filter(([t])=>"ng-add"!==t);if(0===n.length)throw new Error(`No public generation schematic found for "${this.name}" collection, so it is dropped.`);a.Output.logInfo(`${n.length} filtered schematic(s) keeped for "${this.name}" collection: ${n.map(([t])=>t).join(", ")}`);for(const[e,i]of n){const n=this.getFullSchematicName(e);a.Output.logInfo(`Loading "${n}" schematic`);let l=void 0;if(i.extends){const[o]=i.extends.split(":"),n=yield c.findCollectionFsPath(t,o);n?l={name:e,collectionName:this.name,description:`Schematic herited from "${o}"`,collectionFsPath:n}:a.Output.logWarning(`"${this.name}" collection wants to inherit "${e}" schematic from "${i.extends}" collection, but the latest cannot be found.`)}else if(i.schema){const t=s.join(s.dirname(o),i.schema);l={name:e,collectionName:this.name,description:i.description,fsPath:t}}if(l){const t=new r.Schematic(l.name,l.collectionName);try{yield t.init({fsPath:l.fsPath,collectionFsPath:l.collectionFsPath}),this.schematics.set(e,t),this.setSchematicChoice(l)}catch(t){a.Output.logError(`"${n}" schematic loading failed.`)}}}this.schematicsChoices=this.schematicsChoices.sort((t,e)=>t.label.localeCompare(e.label))}))}setSchematicChoice(t){this.schematicsChoices.push({label:t.name,description:t.description})}}},function(t,e,o){"use strict";var i=this&&this.__awaiter||function(t,e,o,i){return new(o||(o=Promise))((function(n,s){function a(t){try{c(i.next(t))}catch(t){s(t)}}function r(t){try{c(i.throw(t))}catch(t){s(t)}}function c(t){var e;t.done?n(t.value):(e=t.value,e instanceof o?e:new o((function(t){t(e)}))).then(a,r)}c((i=i.apply(t,e||[])).next())}))};Object.defineProperty(e,"__esModule",{value:!0});const n=o(2),s=o(1);e.Schematic=class{constructor(t,e){this.optionsChoices=[],this.options=new Map,this.requiredOptionsNames=[],this.name=t,this.collectionName=e}init({fsPath:t,collectionFsPath:e}){return i(this,void 0,void 0,(function*(){if(!t){if(!e)throw new Error(`"${this.collectionName}:${this.name}" schematic cannot be extended.`);try{t=yield this.getFsPathFromCollection(e)}catch(t){throw new Error(`"${this.collectionName}:${this.name}" can not be extended.`)}}const o=yield s.FileSystem.parseJsonFile(t);if(!o)throw new Error(`"${this.collectionName}:${this.name}" schematic cannot be loaded.`);const i=this.validateConfig(o);this.options=i.properties,s.Output.logInfo(`${this.options.size} options detected for "${this.name}" schematic: ${Array.from(this.options.keys()).join(", ")}`),this.requiredOptionsNames=this.initRequiredOptions(i),s.Output.logInfo(`${this.requiredOptionsNames.length} required option(s) detected for "${this.name}" schematic${this.requiredOptionsNames.length>0?`: ${this.requiredOptionsNames.join(", ")}`:""}`),this.optionsChoices=this.initOptionsChoices(i,this.requiredOptionsNames)}))}getName(){return this.name}getSomeOptions(t){return new Map(t.filter(t=>this.options.has(t)).map(t=>[t,this.options.get(t)]))}getRequiredOptions(){return new Map(this.requiredOptionsNames.map(t=>[t,this.options.get(t)]))}getOptionDefaultValue(t){var e;return null===(e=this.options.get(t))||void 0===e?void 0:e.default}hasOption(t){return this.options.has(t)}hasNameAsFirstArg(){var t,e;for(const[o,i]of this.options)if("name"===o&&"argv"===(null===(t=i.$default)||void 0===t?void 0:t.$source)&&0===(null===(e=i.$default)||void 0===e?void 0:e.index))return!0;return!1}getFsPathFromCollection(t){var e,o,a;return i(this,void 0,void 0,(function*(){const i=yield s.FileSystem.parseJsonFile(t),r=s.JsonValidator.string(null===(a=s.JsonValidator.object(null===(o=s.JsonValidator.object(null===(e=s.JsonValidator.object(i))||void 0===e?void 0:e.schematics))||void 0===o?void 0:o[this.name]))||void 0===a?void 0:a.schema);if(!r)throw new Error;return n.join(n.dirname(t),r)}))}validateConfig(t){var e;const o=s.JsonValidator.object(t);return{properties:new Map(Object.entries(null!==(e=s.JsonValidator.object(null==o?void 0:o.properties))&&void 0!==e?e:{}).map(([t,e])=>{const o=s.JsonValidator.object(e),i=s.JsonValidator.object(null==o?void 0:o.$default);i&&(i.$source=s.JsonValidator.string(i.$source),i.index=s.JsonValidator.number(i.index));let n=s.JsonValidator.object(null==o?void 0:o.items);const a=s.JsonValidator.string(null==o?void 0:o["x-prompt"]),r=s.JsonValidator.object(null==o?void 0:o["x-prompt"]);if(n)n.enum=this.validateConfigArrayChoices(s.JsonValidator.array(n.enum));else if(r){!0===s.JsonValidator.boolean(r.multiselect)&&(n={},n.enum=this.validateConfigArrayChoices(s.JsonValidator.array(r.items)))}return[t,{type:s.JsonValidator.string(null==o?void 0:o.type),description:s.JsonValidator.string(null==o?void 0:o.description),visible:s.JsonValidator.boolean(null==o?void 0:o.visible),default:null==o?void 0:o.default,$default:i,enum:this.validateConfigArrayChoices(s.JsonValidator.array(null==o?void 0:o.enum)),items:n,"x-deprecated":s.JsonValidator.string(null==o?void 0:o["x-deprecated"]),"x-prompt":null!=a?a:s.JsonValidator.string(null==r?void 0:r.message)}]})),required:s.JsonValidator.array(null==o?void 0:o.required,"string")}}validateConfigArrayChoices(t){if(void 0!==t)return t.map(t=>{var e,o;return null!==(o=null!==(e=s.JsonValidator.string(t))&&void 0!==e?e:s.JsonValidator.number(t))&&void 0!==o?o:s.JsonValidator.boolean(t)}).map(t=>(null!=t?t:"").toString()).filter(t=>t)}initRequiredOptions(t){var e;return(null!==(e=t.required)&&void 0!==e?e:[]).filter(e=>void 0===t.properties.get(e).$default)}initOptionsChoices(t,e){const o=[],i=Array.from(t.properties).filter(([t])=>"project"!==t).filter(([t,e])=>!1!==e.visible).filter(([t,e])=>void 0===e["x-deprecated"]).filter(([t,e])=>!(e.$default&&"argv"===e.$default.$source&&0===e.$default.index));for(const[t,n]of i){let i=!1,s="";void 0===n.$default&&(e.includes(t)?(i=!0,s="(required) "):void 0!==n["x-prompt"]&&(i=!0,s="(suggested) ")),o.push({label:t,description:`${s}${n.description}`,picked:i})}return[...o.filter(t=>t.picked).sort((t,e)=>t.label.localeCompare(e.label)),...o.filter(t=>!t.picked).sort((t,e)=>t.label.localeCompare(e.label))]}}},function(t,e,o){"use strict";var i=this&&this.__awaiter||function(t,e,o,i){return new(o||(o=Promise))((function(n,s){function a(t){try{c(i.next(t))}catch(t){s(t)}}function r(t){try{c(i.throw(t))}catch(t){s(t)}}function c(t){var e;t.done?n(t.value):(e=t.value,e instanceof o?e:new o((function(t){t(e)}))).then(a,r)}c((i=i.apply(t,e||[])).next())}))};Object.defineProperty(e,"__esModule",{value:!0});const n=o(2),s=o(1);e.findCollectionFsPath=function(t,e,{silent:o=!1}={}){var a;return i(this,void 0,void 0,(function*(){if(e.startsWith(".")&&e.endsWith(".json")){const i=n.join(t.uri.fsPath,e);if(!(yield s.FileSystem.isReadable(i,{silent:o})))return;return i}{const i=yield s.FileSystem.findPackageFsPath(t,t.uri.fsPath,e,{silent:o});if(!i)return;const r=yield s.FileSystem.parseJsonFile(i),c=s.JsonValidator.string(null===(a=s.JsonValidator.object(r))||void 0===a?void 0:a.schematics);if(!c)return;const l=n.join(n.dirname(i),c);if(!(yield s.FileSystem.isReadable(l,{silent:o})))return;return l}}))}},function(t,e,o){"use strict";var i=this&&this.__awaiter||function(t,e,o,i){return new(o||(o=Promise))((function(n,s){function a(t){try{c(i.next(t))}catch(t){s(t)}}function r(t){try{c(i.throw(t))}catch(t){s(t)}}function c(t){var e;t.done?n(t.value):(e=t.value,e instanceof o?e:new o((function(t){t(e)}))).then(a,r)}c((i=i.apply(t,e||[])).next())}))};Object.defineProperty(e,"__esModule",{value:!0});const n=o(2),s=o(1),a=o(6),r=o(14);e.AngularProject=class{constructor(t,e){this.name=t,this.schematicsDefaults=e.schematics,this.type=e.projectType,this.rootPath=e.root,void 0!==e.sourceRoot?this.sourcePath=e.sourceRoot:(this.sourcePath=n.posix.join(this.rootPath,"src"),s.Output.logWarning(`Your Angular configuration file should contain a "sourceRoot" string property for your "${this.name}" project. Default to "${this.sourcePath}".`));const o="library"===e.projectType?"lib":"app";this.appOrLibPath=n.posix.join(this.sourcePath,o),s.Output.logInfo(`"${t}" Angular project is of type "${this.type}" and its path is: ${this.appOrLibPath}.`),this.sourcePath.startsWith(this.rootPath)||s.Output.logError(`"root" and "sourceRoot" of "${this.name}" project do not start by the same path in angular.json`)}init(t){return i(this,void 0,void 0,(function*(){s.Output.logInfo(`Loading "${this.name}" Angular project's TSLint configuration.`);const e=n.join(t.uri.fsPath,this.rootPath),o=new r.TslintConfig,i=yield o.init(e,{silent:!0});this.tslintConfig=o;const c=new a.ComponentShortcut;return yield c.init(t),this.componentShortcut=c,i}))}getRootPath(){return this.rootPath}getSourcePath(){return this.sourcePath}getAppOrLibPath(){return this.appOrLibPath}getComponentSuffixes(){return this.tslintConfig.componentSuffixes}getType(){return this.type}hasComponentSuffix(t){return this.tslintConfig.hasComponentSuffix(t)}getSchematicsOptionDefaultValue(t,e){var o,i;return null===(i=null===(o=this.schematicsDefaults)||void 0===o?void 0:o.get(t))||void 0===i?void 0:i[e]}}},function(t,e,o){"use strict";var i=this&&this.__awaiter||function(t,e,o,i){return new(o||(o=Promise))((function(n,s){function a(t){try{c(i.next(t))}catch(t){s(t)}}function r(t){try{c(i.throw(t))}catch(t){s(t)}}function c(t){var e;t.done?n(t.value):(e=t.value,e instanceof o?e:new o((function(t){t(e)}))).then(a,r)}c((i=i.apply(t,e||[])).next())}))};Object.defineProperty(e,"__esModule",{value:!0});const n=o(0),s=o(2),a=o(1);e.TslintConfig=class{constructor(){this.componentSuffixes=[]}init(t,{silent:e=!1}={}){return i(this,void 0,void 0,(function*(){const o=s.join(t,"tslint.json"),i=yield a.FileSystem.parseJsonFile(o,{silent:e}),r=this.validateConfig(i);return this.initComponentSuffixes(r),a.Output.logInfo(`${this.componentSuffixes.length} custom component suffixe(s) detected in TSLint config${this.componentSuffixes.length>0?`: ${this.componentSuffixes.join(", ")}`:""}`),n.workspace.createFileSystemWatcher(o)}))}hasComponentSuffix(t){return this.componentSuffixes.includes(t.toLowerCase())}validateConfig(t){var e,o;const i=null!==(o=a.JsonValidator.object(null===(e=a.JsonValidator.object(t))||void 0===e?void 0:e.rules))&&void 0!==o?o:{},n=a.JsonValidator.array(null==i?void 0:i["component-class-suffix"]);return{rules:{"component-class-suffix":a.JsonValidator.array(null==n?void 0:n.slice(1),"string")}}}initComponentSuffixes(t){var e,o;this.componentSuffixes=Array.from(new Set(null!==(o=null===(e=null==t?void 0:t.rules)||void 0===e?void 0:e["component-class-suffix"])&&void 0!==o?o:[])).map(t=>t.toLowerCase())}}},function(t,e,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const i=o(0),n=o(3),s=o(1),a=o(5),r=o(4),c=o(30);let l;e.activate=function(t){s.Output.logInfo(`${n.extensionName} extension has been activated.`),i.commands.executeCommand("setContext","inAngularProject",!0),a.Workspace.init(),a.Workspace.whenStable().then(()=>{l=i.window.createTreeView("angular-schematics",{treeDataProvider:new c.SchematicsTreeDataProvider}),l.message="Hello! While this list is useful to see all the schematics available,\n        it is easier to launch a generation with a right-click on a folder in the Explorer,\n        as then the extension will infer the workspace folder, the path and the project."}).catch(),t.subscriptions.push(i.commands.registerCommand("ngschematics.generateComponent",t=>{s.Output.logInfo("Starting journey to generate a component."),(new r.UserJourney).start(t,n.angularCollectionName,"component")}),i.commands.registerCommand("ngschematics.generateService",t=>{s.Output.logInfo("Starting journey to generate a service."),(new r.UserJourney).start(t,n.angularCollectionName,"service")}),i.commands.registerCommand("ngschematics.generateModule",t=>{s.Output.logInfo("Starting journey to generate a module."),(new r.UserJourney).start(t,n.angularCollectionName,"module")}),i.commands.registerCommand("ngschematics.generate",(t,e)=>{s.Output.logInfo("Starting journey to generate a schematics."),(new r.UserJourney).start(t,null==e?void 0:e.collectionName,null==e?void 0:e.schematicName)}))},e.deactivate=function(){for(const[,t]of a.Workspace.folders)t.disposeWatchers();s.Terminal.disposeAll(),s.Output.dispose(),null==l||l.dispose()}},function(t,e,o){"use strict";var i=this&&this.__awaiter||function(t,e,o,i){return new(o||(o=Promise))((function(n,s){function a(t){try{c(i.next(t))}catch(t){s(t)}}function r(t){try{c(i.throw(t))}catch(t){s(t)}}function c(t){var e;t.done?n(t.value):(e=t.value,e instanceof o?e:new o((function(t){t(e)}))).then(a,r)}c((i=i.apply(t,e||[])).next())}))};Object.defineProperty(e,"__esModule",{value:!0});const n=o(17),s=o(2),a=o(8);class r{static findPackageFsPath(t,e,o,{silent:n=!1}={}){var r;return i(this,void 0,void 0,(function*(){const i=s.join(e,this.defaultNodeModulesPath,o,"package.json");if(void 0===this.packagesCache.get(`${t.name}:${o}`))if(yield this.isReadable(i,{silent:!0}))this.packagesCache.set(`${t.name}:${o}`,i);else{const i=s.join(e,"..");if(e!==i)return yield this.findPackageFsPath(t,i,o,{silent:n});this.packagesCache.set(`${t.name}:${o}`,null),n||a.Output.logError(`"${o}" package not found in any "node_modules" folder.`)}return null!==(r=this.packagesCache.get(`${t.name}:${o}`))&&void 0!==r?r:void 0}))}static isReadable(t,{silent:e=!1}={}){return i(this,void 0,void 0,(function*(){if(this.readableFiles.has(t))return!0;try{yield n.promises.access(t,n.constants.F_OK|n.constants.R_OK)}catch(o){return e||this.logError(t,"ENOENT"===(null==o?void 0:o.code)?"found":"read"),!1}return this.readableFiles.add(t),!0}))}static parseJsonFile(t,{silent:e=!1}={}){return i(this,void 0,void 0,(function*(){if(yield this.isReadable(t,{silent:e})){let o;try{let e=yield n.promises.readFile(t,{encoding:"utf8"});(t.includes("@angular/material")||t.includes("@ngx-formly/schematics"))&&(e=e.split("\n").map(t=>t.replace(/^ *\/\/.*/,"")).join("\n")),o=JSON.parse(e)}catch(o){return void(e||this.logError(t,"parsed"))}return o}}))}static removeFilename(t){return s.posix.basename(t).includes(".")?s.posix.dirname(t):t}static logError(t,e){const o=`"${t}" can not be ${e}.`;a.Output.logError(o)}}e.FileSystem=r,r.defaultNodeModulesPath="node_modules",r.packagesCache=new Map,r.readableFiles=new Set},function(t,e){t.exports=require("fs")},function(t,e,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const i=o(0),n=o(3);class s{static send(t,e){const o=this.getTerminal(t);o.show(),o.sendText(e)}static disposeAll(){for(const t of this.terminals.values())t.dispose()}static getTerminal(t){const e=`${n.extensionName} - ${t.name}`;return this.terminals.has(t.name)&&this.isTerminalExisting(e)||this.terminals.set(t.name,i.window.createTerminal({name:e,cwd:t.uri.fsPath})),this.terminals.get(t.name)}static isTerminalExisting(t){return i.window.terminals.map(t=>t.name).includes(t)}}e.Terminals=s,s.terminals=new Map},function(t,e,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0});e.JsonValidator=class{static boolean(t){if("boolean"==typeof t)return t}static number(t){if("number"==typeof t)return t}static string(t){if("string"==typeof t)return t}static array(t,e){if(Array.isArray(t)&&(!e||t.length===t.filter(t=>typeof t===e).length))return t}static object(t){if("object"==typeof t&&null!==t)return t}}},function(t,e,o){"use strict";var i=this&&this.__awaiter||function(t,e,o,i){return new(o||(o=Promise))((function(n,s){function a(t){try{c(i.next(t))}catch(t){s(t)}}function r(t){try{c(i.throw(t))}catch(t){s(t)}}function c(t){var e;t.done?n(t.value):(e=t.value,e instanceof o?e:new o((function(t){t(e)}))).then(a,r)}c((i=i.apply(t,e||[])).next())}))};Object.defineProperty(e,"__esModule",{value:!0});const n=o(0),s=o(1),a=o(9);class r{static init(){var t;return i(this,void 0,void 0,(function*(){const e=Date.now(),o=null!==(t=n.workspace.workspaceFolders)&&void 0!==t?t:[];o.length>0?s.Output.logInfo(`${o.length} workspace folder(s) detected.`):s.Output.logError("No workspace folder detected.");for(const t of o)yield this.add(t);this.stable=!0;const i=Date.now()-e;s.Output.logInfo(`Configurations of all workspace folders are now ready. Duration: ${i}ms.`),this.watcher=n.workspace.onDidChangeWorkspaceFolders(t=>{var e;for(const e of t.added)s.Output.logInfo(`Loading configuration of new "${e.name}" workspace folder.`),this.add(e);for(const o of t.removed)s.Output.logInfo(`Unloading configuration of removed "${o.name}" workspace folder.`),null===(e=this.folders.get(o.name))||void 0===e||e.disposeWatchers(),this.folders.delete(o.name)})}))}static getFolderFromPath(t){const e=n.Uri.file(t);return n.workspace.getWorkspaceFolder(e)}static askFolder(t){var e,o,a;return i(this,void 0,void 0,(function*(){let i;if(t&&(s.Output.logInfo("Context path detected: resolving current workspace folder from it."),i=null===(e=n.workspace.getWorkspaceFolder(t))||void 0===e?void 0:e.name),!i)if(1===(null===(o=n.workspace.workspaceFolders)||void 0===o?void 0:o.length))s.Output.logInfo("There is only one workspace folder opened, default to it."),i=n.workspace.workspaceFolders[0].name;else{s.Output.logInfo("There are multiple Code workspaces opened, ask the user which one we should use.");const t=Array.from(this.folders).map(([t,e])=>({label:t,description:e.uri.fsPath}));if(t.length>0){const e=yield n.window.showQuickPick(t,{placeHolder:"In which of your Angular workspace folders do you want to generate?",ignoreFocusOut:!0});i=null==e?void 0:e.label}else i=null===(a=yield n.window.showWorkspaceFolderPick())||void 0===a?void 0:a.name}if(!i)return;const r=this.folders.get(i);if(!r)throw new Error;return r}))}static whenStable(){return i(this,void 0,void 0,(function*(){if(!this.stable){const t=new Promise(t=>{this.isStable(t)}),e=new Promise((t,e)=>{setTimeout(()=>{e()},1e4)});return Promise.race([t,e])}}))}static isStable(t){this.stable?t():setTimeout(()=>{this.isStable(t)},1e3)}static add(t){return i(this,void 0,void 0,(function*(){s.Output.logInfo(`Loading configuration of "${t.name}" workspace folder.`);try{const e=new a.WorkspaceFolderConfig(t);yield e.init(),this.folders.set(t.name,e)}catch(e){s.Output.logError(`"${t.name}" was dropped as it does not contain any Angular config file. Add a "angular.json" file in your project with \`{ "version": 1 }\``)}}))}}e.Workspace=r,r.folders=new Map,r.stable=!1},function(t,e,o){"use strict";var i=this&&this.__awaiter||function(t,e,o,i){return new(o||(o=Promise))((function(n,s){function a(t){try{c(i.next(t))}catch(t){s(t)}}function r(t){try{c(i.throw(t))}catch(t){s(t)}}function c(t){var e;t.done?n(t.value):(e=t.value,e instanceof o?e:new o((function(t){t(e)}))).then(a,r)}c((i=i.apply(t,e||[])).next())}))};Object.defineProperty(e,"__esModule",{value:!0});const n=o(0),s=o(2),a=o(3),r=o(1),c=o(5),l=o(6),u=o(25),h=o(7);class d{constructor(){this.projectName=""}start(t,e,o){return i(this,void 0,void 0,(function*(){try{yield n.window.withProgress({location:n.ProgressLocation.Window,title:`${a.extensionName}: loading configuration, please wait...`},()=>c.Workspace.whenStable())}catch(t){return void r.Output.showError(`Loading configurations needed for ${a.extensionName} extension was too long. Check Output channel for error logs.`)}let i;try{i=yield c.Workspace.askFolder(t)}catch(t){return void r.Output.showError('No valid Angular config file found for the chosen workspace. Add a "angular.json" file in your project with `{ "version": 1 }`')}if(!i)return void r.Output.logInfo("You have canceled the workspace folder choice.");if(this.workspaceFolder=i,r.Output.logInfo(`Workspace folder selected: "${i.name}"`),this.cliCommand=new u.CliCommand(i,null==t?void 0:t.path),!this.cliCommand.getProjectName()&&this.workspaceFolder.getAngularProjects().size>0){const t=yield this.askProjectName();if(!t)return void r.Output.logInfo("You have canceled the Angular project choice.");this.cliCommand.setProjectName(t)}if(this.projectName=this.cliCommand.getProjectName(),this.projectName&&r.Output.logInfo(`Angular project used: "${this.cliCommand.getProjectName()}"`),!e){try{e=yield this.askCollectionName()}catch(t){return void this.showCollectionMissingErrorWithFix(a.angularCollectionName)}if(!e)return void r.Output.logInfo("You have canceled the collection choice.")}r.Output.logInfo(`Collection used: "${e}"`),this.cliCommand.setCollectionName(e);const s=this.workspaceFolder.collections.getCollection(e);if(!s)return void this.showCollectionMissingErrorWithFix(e);if(this.collection=s,!o&&!(o=yield this.askSchematicName()))return void r.Output.logInfo("You have canceled the schematic choice.");r.Output.logInfo(`Schematic used: "${e}:${o}"`);const l=this.collection.getSchematic(o);if(!l)return void r.Output.showError(`Cannot load "${e}:${o}" schematic. See Output channel for error logs.`);if(this.schematic=l,this.cliCommand.setSchematic(l),!(yield this.cliCommand.validateProject())){const t=yield this.askSourcePath();if(!t)return void r.Output.logInfo("You have canceled the source path choice.");this.cliCommand.addOptions([["path",t]])}let h;if(this.schematic.hasNameAsFirstArg()){if(r.Output.logInfo("This schematic has a default argument to set the path and name."),h=yield this.askNameAsFirstArg(),!h)return void r.Output.logInfo("You have canceled the default argument input.");this.cliCommand.setNameAsFirstArg(h)}let p=!1;if(e===a.angularCollectionName&&d.shortcutSchematics.includes(o)){let t;if("component"===o){if(t=yield this.askComponentOptions(),!t)return void r.Output.logInfo("You have canceled the component type choice.")}else if("module"===o){if(t=yield this.askModuleOptions(),!t)return void r.Output.logInfo("You have canceled the module type choice.");if(!t.has("module")){const t=yield this.askWhereToImportModule();t&&this.cliCommand.addOptions([["module",t]])}}if(t&&this.cliCommand.addOptions(t),p=yield this.askShortcutConfirmation(),void 0===p)return void r.Output.logInfo("You have canceled the generation.")}if(!p){const t=yield this.askOptions();if(this.cliCommand.addOptions(t),!(yield this.askConfirmation()))return void r.Output.logInfo("You have canceled the generation.")}this.cliCommand.launchCommand();try{yield n.window.withProgress({location:n.ProgressLocation.Notification,title:`${a.extensionName}: launching the generation, please wait...`},()=>this.jumpToFile(this.cliCommand.guessGereratedFileFsPath()))}catch(t){this.showUnknownStatus()}}))}askProjectName(){return i(this,void 0,void 0,(function*(){if(1===this.workspaceFolder.getAngularProjects().size)return Array.from(this.workspaceFolder.getAngularProjects().keys())[0];{const t=Array.from(this.workspaceFolder.getAngularProjects()).map(([t,e])=>{const o=`${this.workspaceFolder.isRootAngularProject(t)?"root ":""}${e.getType()} in ${e.getAppOrLibPath()}`;return{label:t,description:`${o[0].toUpperCase()}${o.substr(1)}`}}),e=yield n.window.showQuickPick(t,{placeHolder:"In which your Angular projects do you want to generate?",ignoreFocusOut:!0});return null==e?void 0:e.label}}))}askCollectionName(){return i(this,void 0,void 0,(function*(){if(0===this.workspaceFolder.collections.getCollectionsNames().length)throw new Error;if(1===this.workspaceFolder.collections.getCollectionsNames().length){const t=this.workspaceFolder.collections.getCollectionsNames()[0];return r.Output.logInfo(`Only collection detected: "${t}". Default to it.`),t}return r.Output.logInfo("Multiple collections detected: ask the user which one to use."),n.window.showQuickPick(this.workspaceFolder.collections.getCollectionsNames(),{placeHolder:"What schematics collection do you want to use?",ignoreFocusOut:!0})}))}askSchematicName(){return i(this,void 0,void 0,(function*(){const t=yield n.window.showQuickPick(this.collection.schematicsChoices,{placeHolder:"What schematics do you want to generate?",ignoreFocusOut:!0});return t?t.label:void 0}))}askSourcePath(){return i(this,void 0,void 0,(function*(){return n.window.showInputBox({prompt:'What is the source path? (Pro-tip: the extension can detect it with a correct "angular.json" or if there is an "app.module.ts" file)',placeHolder:"src/app",ignoreFocusOut:!0})}))}askNameAsFirstArg(){return i(this,void 0,void 0,(function*(){const t=this.cliCommand.getProjectName(),e=this.cliCommand.getContextForNameAsFirstArg();r.Output.logInfo(`Context path detected for default argument: "${e}"`);let o=`Choose the name${this.schematic.hasOption("path")?" or path/to/name":""}.`;this.schematic.hasOption("path")&&this.workspaceFolder.isRootAngularProject(t)&&!e&&(o=`${o} Pro-tip: the path can be inferred if you right-click on the directory where you want to generate.`);const i=yield n.window.showInputBox({prompt:o,value:e,valueSelection:[e.length,e.length],ignoreFocusOut:!0}),s=`.${this.schematic.getName()}`;return(null==i?void 0:i.endsWith(s))?i.replace(s,""):i}))}askComponentOptions(){var t;return i(this,void 0,void 0,(function*(){const e=this.workspaceFolder.getComponentTypes(this.projectName),o=Array.from(e.values()).map(t=>t.choice),i=yield n.window.showQuickPick(o,{placeHolder:"What type of component do you want?",ignoreFocusOut:!0});return i?null===(t=e.get(i.label))||void 0===t?void 0:t.options:void 0}))}askModuleOptions(){var t;return i(this,void 0,void 0,(function*(){const e=this.workspaceFolder.getModuleTypes(),o=e.get(l.MODULE_TYPE.LAZY);if(o){const t=this.cliCommand.getRouteFromFirstArg();o.options.set("route",t),o.choice.description=h.formatCliCommandOptions(o.options)}const i=Array.from(e.values()).map(t=>t.choice),s=yield n.window.showQuickPick(i,{placeHolder:"What type of module do you want?",ignoreFocusOut:!0});return s?null===(t=e.get(s.label))||void 0===t?void 0:t.options:void 0}))}askWhereToImportModule(){return i(this,void 0,void 0,(function*(){const t=new n.RelativePattern(this.cliCommand.getProjectSourcePath(),"**/*.module.ts"),e=(yield n.window.withProgress({location:n.ProgressLocation.Notification,title:`${a.extensionName}: looking for existing modules, please wait...`},()=>n.workspace.findFiles(t,void 0,50))).filter(t=>!t.fsPath.includes("-routing")).map(t=>s.basename(t.fsPath));if(0===e.length)return;e.unshift("Nowhere");const o=yield n.window.showQuickPick(e,{placeHolder:"Where do you want to import the module?",ignoreFocusOut:!0});return"Nowhere"!==o?null==o?void 0:o.replace(".module.ts",""):void 0}))}askShortcutConfirmation(){return i(this,void 0,void 0,(function*(){const t=yield n.window.showQuickPick(l.shortcutsConfirmationChoices,{placeHolder:this.cliCommand.getCommand(),ignoreFocusOut:!0});return(null==t?void 0:t.label)===l.SHORTCUTS_CONFIRMATION_LABEL.YES||(null==t?void 0:t.label)!==l.SHORTCUTS_CONFIRMATION_LABEL.MORE_OPTIONS&&void 0}))}askOptions(){return i(this,void 0,void 0,(function*(){const t=yield this.askOptionsNames();return t?yield this.askOptionsValues(t):new Map}))}askOptionsNames(){return i(this,void 0,void 0,(function*(){const t=this.schematic.optionsChoices;return 0===t.length?[]:((yield n.window.showQuickPick(t,{canPickMany:!0,placeHolder:"Do you need some options? (if not, just press Enter to skip this step)",ignoreFocusOut:!0}))||[]).map(t=>t.label)}))}askOptionsValues(t){var e,o,n;return i(this,void 0,void 0,(function*(){const i=[...this.schematic.getRequiredOptions(),...this.schematic.getSomeOptions(t)],s=new Map;for(let[t,a]of i){let i="";const r=null!==(o=null!==(e=null==a?void 0:a["x-prompt"])&&void 0!==e?e:a.description)&&void 0!==o?o:"What value do you want for this option?";if(void 0!==a.enum)i=yield this.askOptionEnum(t,a.enum,r);else if("boolean"===a.type){const e=!1===a.default?["false","true"]:["true","false"];i=yield this.askOptionEnum(t,e,r)}else i="array"===a.type&&(null===(n=a.items)||void 0===n?void 0:n.enum)?yield this.askOptionMultiselect(t,a.items.enum,r):yield this.askOptionText(t,r);i&&s.set(t,i)}return s}))}askOptionText(t,e){return i(this,void 0,void 0,(function*(){return n.window.showInputBox({prompt:`--${t}: ${e}`,ignoreFocusOut:!0})}))}askOptionEnum(t,e,o){return i(this,void 0,void 0,(function*(){return n.window.showQuickPick(e,{placeHolder:`--${t}: ${o}`,ignoreFocusOut:!0})}))}askOptionMultiselect(t,e,o){return i(this,void 0,void 0,(function*(){return n.window.showQuickPick(e,{placeHolder:`--${t}: ${o}`,canPickMany:!0,ignoreFocusOut:!0})}))}askConfirmation(){return i(this,void 0,void 0,(function*(){const t=[{label:"$(check) Confirm",description:"Pro-tip: take a minute to check the command above is really what you want"},{label:"$(close) Cancel"}],e=yield n.window.showQuickPick(t,{placeHolder:this.cliCommand.getCommand(),ignoreFocusOut:!0});return"$(check) Confirm"===(null==e?void 0:e.label)}))}jumpToFile(t,e=0){return i(this,void 0,void 0,(function*(){if(""===t)throw new Error;if(yield r.FileSystem.isReadable(t,{silent:!0})){const e=yield n.workspace.openTextDocument(t);return yield n.window.showTextDocument(e),void r.Output.logInfo("Command has succeeded! Check the Terminal for more details.")}if(!(e<10))throw new Error;e+=1,yield new Promise((o,i)=>{setTimeout(()=>{this.jumpToFile(t,e).then(()=>{o()}).catch(()=>{i()})},500)})}))}showUnknownStatus(){return i(this,void 0,void 0,(function*(){r.Output.logInfo("Command launched."),"Refresh Explorer"===(yield n.window.showInformationMessage("Command launched, check the Terminal to know its status. You may need to refresh the Explorer to see the generated file(s).","Refresh Explorer"))&&n.commands.executeCommand("workbench.files.action.refreshFilesExplorer")}))}showCollectionMissingErrorWithFix(t){return i(this,void 0,void 0,(function*(){const e=t===a.angularCollectionName?`"${t}" should be present in a correctly installed Angular project.`:`Cannot load "${t}" collection. It may not exist in "${this.workspaceFolder.name}" workspace folder.`;r.Output.logError(e);const o="Try to npm install the missing schematics";if((yield n.window.showErrorMessage(e,o))===o){r.Output.logInfo(`Trying to npm install ${t}`),r.Terminal.send(this.workspaceFolder,`npm install ${t} --save-dev`);const e="Reload window";(yield n.window.showInformationMessage("Once the npm install is finished, the project must be reloaded.",e))===e&&n.commands.executeCommand("workbench.action.reloadWindow")}}))}}e.UserJourney=d,d.shortcutSchematics=["component","service","module"]},function(t,e,o){"use strict";var i;Object.defineProperty(e,"__esModule",{value:!0}),function(t){t.YES="$(check) Confirm",t.MORE_OPTIONS="$(gear) Add more options",t.NO="$(close) Cancel"}(i=e.SHORTCUTS_CONFIRMATION_LABEL||(e.SHORTCUTS_CONFIRMATION_LABEL={})),e.shortcutsConfirmationChoices=[{label:i.YES,description:"Pro-tip: take a minute to check the command above is really what you want"},{label:i.MORE_OPTIONS,description:'Pro-tip: you can set default values to "schematics" options in angular.json'},{label:i.NO}]},function(t,e,o){"use strict";var i=this&&this.__awaiter||function(t,e,o,i){return new(o||(o=Promise))((function(n,s){function a(t){try{c(i.next(t))}catch(t){s(t)}}function r(t){try{c(i.throw(t))}catch(t){s(t)}}function c(t){var e;t.done?n(t.value):(e=t.value,e instanceof o?e:new o((function(t){t(e)}))).then(a,r)}c((i=i.apply(t,e||[])).next())}))};Object.defineProperty(e,"__esModule",{value:!0});const n=o(0),s=o(3),a=o(1),r=o(4);var c;!function(t){t.DEFAULT="$(thumbsdown) Default component",t.PAGE="$(preview) Page",t.PURE="$(zap) Pure component",t.EXPORTED="$(link-external) Exported component"}(c=e.COMPONENT_TYPE||(e.COMPONENT_TYPE={}));e.ComponentShortcut=class{constructor(){this.types=new Map}init(t){return i(this,void 0,void 0,(function*(){this.types.clear(),this.types.set(c.DEFAULT,{choice:{label:c.DEFAULT,detail:"Component with no special behavior (pro-tip: learn about component types in our documentation)"},options:new Map}),this.types.set(c.PAGE,{choice:{label:c.PAGE,detail:"Component associated to a route"},options:new Map([["type","page"],["skipSelector","true"]])}),this.types.set(c.PURE,{choice:{label:c.PURE,detail:"UI / presentation component, used only in its own feature module"},options:new Map([["changeDetection","OnPush"]])}),this.types.set(c.EXPORTED,{choice:{label:c.EXPORTED,detail:"UI / presentation component, declared in a shared UI module and used in multiple feature modules"},options:new Map([["export","true"],["changeDetection","OnPush"]])});for(const e of yield this.getCustomComponentTypes(t))this.types.set(e.label,{choice:{label:e.label,detail:e.detail},options:new Map(e.options)});for(const[,t]of this.types)t.choice.description=r.formatCliCommandOptions(t.options)||"No pre-filled option"}))}getCustomComponentTypes(t){return i(this,void 0,void 0,(function*(){const e=new Map;for(const o of s.defaultComponentTypes)(yield a.FileSystem.findPackageFsPath(t,t.uri.fsPath,o.package,{silent:!0}))&&e.set(o.label,o);let o=n.workspace.getConfiguration("ngschematics",t.uri).get("componentTypes",[]);if(""===o&&(o=[]),Array.isArray(o)){a.Output.logInfo(`${o.length} custom component type(s) detected in the preferences.`);for(const t of o){const o=this.validateUserComponentType(t);o&&(e.has(o.label)&&a.Output.logWarning(`"${o.label}" component type already exists.`),e.set(o.label,o),a.Output.logInfo(`Adding "${o.label}" custom component type.`))}}else a.Output.logWarning('"ngschematics.componentTypes" option has changed in version >= 4. See the changelog to update it.'),o=[];return Array.from(e.values())}))}validateUserComponentType(t){const e=a.JsonValidator.object(t),o=a.JsonValidator.string(null==e?void 0:e.label),i=a.JsonValidator.array(null==e?void 0:e.options);if(!o||!i)return;const n=[];for(const t of i){const e=a.JsonValidator.array(t);if(!e||2!==e.length)return;const o=a.JsonValidator.string(e[0]),i=a.JsonValidator.string(e[1]);if(!o||void 0===i)return;n.push([o,i])}return{label:o,detail:a.JsonValidator.string(null==e?void 0:e.detail),options:n,package:""}}}},function(t,e,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const i=o(4);var n;!function(t){t.DEFAULT="$(extensions) Module of components",t.LAZY="$(zap) Lazy-loaded module of pages",t.ROUTING="$(files) Classic module of pages"}(n=e.MODULE_TYPE||(e.MODULE_TYPE={}));e.ModuleShortcut=class{constructor(){this.types=new Map}init(t){this.types.clear(),this.types.set(n.DEFAULT,{choice:{label:n.DEFAULT,detail:"Module of UI / presentation components"},options:new Map}),t&&this.types.set(n.LAZY,{choice:{label:n.LAZY,detail:"Module with routing, lazy-loaded"},options:new Map([["module","app"]])}),this.types.set(n.ROUTING,{choice:{label:n.ROUTING,detail:"Module with routing, immediately loaded"},options:new Map([["module","app"],["routing","true"]])});for(const[,t]of this.types)t.choice.description=i.formatCliCommandOptions(t.options)||"No pre-filled option"}}},function(t,e,o){"use strict";var i=this&&this.__awaiter||function(t,e,o,i){return new(o||(o=Promise))((function(n,s){function a(t){try{c(i.next(t))}catch(t){s(t)}}function r(t){try{c(i.throw(t))}catch(t){s(t)}}function c(t){var e;t.done?n(t.value):(e=t.value,e instanceof o?e:new o((function(t){t(e)}))).then(a,r)}c((i=i.apply(t,e||[])).next())}))};Object.defineProperty(e,"__esModule",{value:!0});const n=o(0),s=o(2),a=o(3),r=o(1),c=o(7);e.CliCommand=class{constructor(t,e){this.workspaceFolder=t,this.contextPath={full:"",relativeToWorkspaceFolder:"",relativeToProjectFolder:""},this.baseCommand="ng g",this.projectName="",this.collectionName=a.angularCollectionName,this.schematicName="",this.nameAsFirstArg="",this.options=new Map,this.setContextPathAndProject(e)}getCommand(){return[this.baseCommand,this.formatSchematicNameForCommand(),this.nameAsFirstArg,c.formatCliCommandOptions(this.options)].join(" ").trim()}setCollectionName(t){this.collectionName=t}setSchematic(t){return i(this,void 0,void 0,(function*(){this.schematicName=t.getName(),this.schematic=t}))}getProjectName(){return this.projectName}getProjectSourcePath(){var t;const e=this.projectName?this.workspaceFolder.getAngularProject(this.projectName).getAppOrLibPath():null!==(t=this.options.get("path"))&&void 0!==t?t:"src/app";return s.join(this.workspaceFolder.uri.fsPath,e)}setProjectName(t){this.projectName=t}validateProject(){return i(this,void 0,void 0,(function*(){if(this.projectName)this.schematic.hasOption("project")&&!this.workspaceFolder.isRootAngularProject(this.projectName)&&this.options.set("project",this.projectName);else{const t=new n.RelativePattern(this.workspaceFolder,"**/app.module.ts"),e=yield n.workspace.findFiles(t,"**/node_modules/**",1);if(!(e.length>0))return r.Output.logWarning('No Angular project or "app.module.ts" detected.'),!1;{const t=e[0].fsPath.substr(this.workspaceFolder.uri.fsPath.length+1),o=s.posix.normalize(s.dirname(t).replace(/\\/g,"/"));this.options.set("path",o),r.Output.logInfo(`"app.module.ts" detected in: ${o}`)}}return!0}))}getContextForNameAsFirstArg(){if(this.collectionName===a.angularCollectionName&&["application","library"].includes(this.schematicName))return"";if("ngx-spec"===this.collectionName&&"spec"===this.schematicName)return this.contextPath.relativeToProjectFolder;if("ngx-spec"===this.collectionName)return"";const t=r.FileSystem.removeFilename(this.contextPath.relativeToProjectFolder);return["","."].includes(t)?"":`${t}/`}getRouteFromFirstArg(){return s.posix.basename(this.nameAsFirstArg)}setNameAsFirstArg(t){this.nameAsFirstArg=t}addOptions(t){for(const[e,o]of t)this.schematic.hasOption(e)?this.options.set(e,o):r.Output.logWarning(`"--${e}" option has been chosen but does not exist in this schematic, so it won't be used.`)}launchCommand(){r.Output.logInfo(`Launching this command: ${this.getCommand()}`),r.Terminal.send(this.workspaceFolder,this.getCommand())}guessGereratedFileFsPath(){let t="";if(this.nameAsFirstArg){const e=this.getProjectSourcePath();let o=`.${this.schematicName}`;this.collectionName===a.angularCollectionName?["component","class","interface"].includes(this.schematicName)&&this.options.has("type")?o=`.${this.options.get("type")}`:["class","interface"].includes(this.schematicName)?o="":"webWorker"===this.schematicName&&(o=".worker"):["@angular/material","@angular/cdk"].includes(this.collectionName)?o=".component":"@ngrx/schematics"===this.collectionName&&(["action","effect","selector"].includes(this.schematicName)?o=`.${this.schematicName}s`:"entity"===this.schematicName?o=".model":"entity"===this.schematicName?o=".actions":"container"===this.schematicName?o=".component":"data"===this.schematicName&&(o=".service"));const i=s.posix.dirname(this.nameAsFirstArg),n=s.posix.basename(this.nameAsFirstArg),r=`${n}${o}.ts`;let c=!0;if(this.options.has("flat"))c="false"!==this.options.get("flat");else{const t=this.workspaceFolder.getSchematicsOptionDefaultValue(this.projectName,this.getFullSchematicName(),"flat");if(void 0!==t)c=t;else{const t=this.schematic.getOptionDefaultValue("flat");void 0!==t?c=t:(this.collectionName===a.angularCollectionName&&["component","module"].includes(this.schematicName)||"@ngxs/schematics"===this.collectionName)&&(c=!1)}}const l=c?s.join(e,i):s.join(e,i,n);t=s.join(l,r)}return r.Output.logInfo(`Guessed generated file path: ${t}`),t}getFullSchematicName(){return`${this.collectionName}:${this.schematicName}`}formatSchematicNameForCommand(){return this.collectionName!==this.workspaceFolder.getDefaultUserCollection()?this.getFullSchematicName():this.schematicName}setContextPathAndProject(t){if(t){this.contextPath.full=t,r.Output.logInfo(`Full context path detected: ${this.contextPath.full}`),this.contextPath.relativeToWorkspaceFolder=this.contextPath.full.substr(this.workspaceFolder.uri.path.length+1),r.Output.logInfo(`Workspace folder-relative context path detected: ${this.contextPath.relativeToWorkspaceFolder}`);for(const[t,e]of this.workspaceFolder.getAngularProjects())if(this.contextPath.relativeToWorkspaceFolder.startsWith(e.getAppOrLibPath())){this.projectName=t,this.contextPath.relativeToProjectFolder=this.contextPath.relativeToWorkspaceFolder.substr(e.getAppOrLibPath().length+1);break}if(!this.projectName)for(const[t,e]of this.workspaceFolder.getAngularProjects())if(this.contextPath.relativeToWorkspaceFolder.startsWith(e.getSourcePath())){this.projectName=t;break}if(!this.projectName)for(const[t,e]of this.workspaceFolder.getAngularProjects())if(""!==e.getRootPath()&&this.contextPath.relativeToWorkspaceFolder.startsWith(e.getRootPath())){this.projectName=t;break}this.projectName?(r.Output.logInfo(`Source-relative context path detected: ${this.contextPath.relativeToProjectFolder}`),r.Output.logInfo(`Angular project detected from context path: "${this.projectName}"`)):r.Output.logInfo("No Angular project detected from context path.")}else r.Output.logInfo("No context path detected.")}}},function(t,e,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=o(27);e.Collections=i.Collections;var n=o(10);e.Collection=n.Collection;var s=o(11);e.Schematic=s.Schematic},function(t,e,o){"use strict";var i=this&&this.__awaiter||function(t,e,o,i){return new(o||(o=Promise))((function(n,s){function a(t){try{c(i.next(t))}catch(t){s(t)}}function r(t){try{c(i.throw(t))}catch(t){s(t)}}function c(t){var e;t.done?n(t.value):(e=t.value,e instanceof o?e:new o((function(t){t(e)}))).then(a,r)}c((i=i.apply(t,e||[])).next())}))};Object.defineProperty(e,"__esModule",{value:!0});const n=o(0),s=o(3),a=o(1),r=o(10),c=o(12);e.Collections=class{constructor(){this.list=new Map}init(t,e){return i(this,void 0,void 0,(function*(){return yield this.setList(t,e)}))}getCollectionsNames(){return Array.from(this.list.keys())}getCollection(t){return this.list.get(t)}setList(t,e){var o;return i(this,void 0,void 0,(function*(){a.Output.logInfo("Loading the list of schematics collections."),this.list.clear();const i=[],l=n.workspace.getConfiguration("ngschematics",t.uri).get("schematics",[]),u=null!==(o=a.JsonValidator.array(l,"string"))&&void 0!==o?o:[];a.Output.logInfo(`${u.length} user schematics collection(s) detected in Code preferences${u.length>0?`: ${u.join(", ")}`:""}`);const h=Array.from(new Set([...e,...s.defaultCollectionsNames,...u])),d=[];for(const o of h){const i=!e.includes(o)&&!u.includes(o),n=yield c.findCollectionFsPath(t,o,{silent:i});n&&d.push({name:o,fsPath:n})}d.length>0?a.Output.logInfo(`${d.length} installed collection(s) detected: ${d.map(t=>t.name).join(", ")}`):a.Output.logError(`No collection found. "${s.angularCollectionName}" should be present in a correctly installed Angular CLI project. If you are in a non-Angular CLI project, try to run in the Terminal: "npm install ${s.angularCollectionName} --save-dev"`);for(const e of d){a.Output.logInfo(`Loading "${e.name}" collection.`);const o=new r.Collection(e.name);try{const n=yield o.init(t,e.fsPath);this.list.set(e.name,o),n&&i.push(n)}catch(t){a.Output.logError(t.message)}}return i}))}}},function(t,e,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=o(29);e.AngularConfig=i.AngularConfig;var n=o(13);e.AngularProject=n.AngularProject;var s=o(14);e.TslintConfig=s.TslintConfig},function(t,e,o){"use strict";var i=this&&this.__awaiter||function(t,e,o,i){return new(o||(o=Promise))((function(n,s){function a(t){try{c(i.next(t))}catch(t){s(t)}}function r(t){try{c(i.throw(t))}catch(t){s(t)}}function c(t){var e;t.done?n(t.value):(e=t.value,e instanceof o?e:new o((function(t){t(e)}))).then(a,r)}c((i=i.apply(t,e||[])).next())}))};Object.defineProperty(e,"__esModule",{value:!0});const n=o(0),s=o(3),a=o(1),r=o(13);e.AngularConfig=class{constructor(){this.schematicsDefaults=new Map,this.projects=new Map,this.defaultUserCollection=s.angularCollectionName,this.defaultCollections=[],this.rootProjectName=""}init(t,e){return i(this,void 0,void 0,(function*(){const o=yield a.FileSystem.parseJsonFile(e),i=this.validateConfig(o);this.initDefaultCollections(i),a.Output.logInfo(`Default schematics collection detected in your Angular config: ${this.defaultUserCollection}`),this.initSchematicsDefaults(i),a.Output.logInfo(`${i.projects.size} Angular project(s) detected.`);const s=yield this.setProjects(t,i);return s.push(n.workspace.createFileSystemWatcher(e)),s}))}getSchematicsOptionDefaultValue(t,e){var o,i;return null===(i=null===(o=null==this?void 0:this.schematicsDefaults)||void 0===o?void 0:o.get(t))||void 0===i?void 0:i[e]}validateConfig(t){var e,o,i;const n=null!==(e=a.JsonValidator.object(t))&&void 0!==e?e:{},s=a.JsonValidator.number(n.version);if(!s)throw a.Output.logError('Your Angular config file must contain `"version" : 1`, please correct it.'),new Error;const r=["application","library"],c=new Map(Object.entries(null!==(o=a.JsonValidator.object(n.projects))&&void 0!==o?o:{}).filter(([t])=>!t.endsWith("-e2e")).map(([t,e])=>{var o,i;const n=null!==(o=a.JsonValidator.object(e))&&void 0!==o?o:{},s=null!==(i=a.JsonValidator.string(n.projectType))&&void 0!==i?i:"";let c="application";r.includes(s)?c=s:a.Output.logWarning(`Your Angular configuration file should contain a "projectType" property with "application" or "library" for your "${t}" project. Default to "application".`);let l=a.JsonValidator.string(n.root);return void 0===l&&(l="",a.Output.logWarning(`Your Angular configuration file should contain a "root" string property for your "${t}" project. Default to "".`)),[t,{projectType:c,root:l,sourceRoot:a.JsonValidator.string(n.sourceRoot),schematics:this.validateConfigSchematics(n.schematics)}]}));return 0===c.size&&a.Output.logWarning('No "projects" detected in your Angular config file. You should correct that.'),{version:s,cli:{defaultCollection:a.JsonValidator.string(null===(i=a.JsonValidator.object(n.cli))||void 0===i?void 0:i.defaultCollection)},schematics:this.validateConfigSchematics(n.schematics),projects:c}}validateConfigSchematics(t){var e;return new Map(Object.entries(null!==(e=a.JsonValidator.object(t))&&void 0!==e?e:{}).map(([t,e])=>{var o;return[t,{flat:a.JsonValidator.boolean(null===(o=a.JsonValidator.object(e))||void 0===o?void 0:o.flat)}]}))}initDefaultCollections(t){var e,o;this.defaultUserCollection=null!==(o=null===(e=t.cli)||void 0===e?void 0:e.defaultCollection)&&void 0!==o?o:s.angularCollectionName,this.defaultCollections=Array.from(new Set([this.defaultUserCollection,s.angularCollectionName]))}initSchematicsDefaults(t){this.schematicsDefaults=t.schematics}setProjects(t,e){return i(this,void 0,void 0,(function*(){this.rootProjectName="",this.projects.clear();const o=[];for(const[i,n]of e.projects){const e=new r.AngularProject(i,n);o.push(yield e.init(t)),this.projects.set(i,e),this.rootProjectName||""!==n.root||(this.rootProjectName=i,a.Output.logInfo(`"${i}" project is the root Angular project.`))}return o}))}}},function(t,e,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=o(31);e.SchematicsTreeDataProvider=i.SchematicsTreeDataProvider},function(t,e,o){"use strict";var i=this&&this.__awaiter||function(t,e,o,i){return new(o||(o=Promise))((function(n,s){function a(t){try{c(i.next(t))}catch(t){s(t)}}function r(t){try{c(i.throw(t))}catch(t){s(t)}}function c(t){var e;t.done?n(t.value):(e=t.value,e instanceof o?e:new o((function(t){t(e)}))).then(a,r)}c((i=i.apply(t,e||[])).next())}))};Object.defineProperty(e,"__esModule",{value:!0});const n=o(0),s=o(2),a=o(5);e.SchematicsTreeDataProvider=class{constructor(){this.iconPath="",this.collections=new Map;const t=n.extensions.getExtension("cyrilletuzi.angular-schematics");this.iconPath=s.join(t.extensionPath,"angular.svg")}getTreeItem(t){return t}getChildren(t){return i(this,void 0,void 0,(function*(){if(t){const e=this.collections.get(t.label);return e.getSchematicsNames().map(t=>{const o=new n.TreeItem(t,n.TreeItemCollapsibleState.None);return o.command={title:`Generate ${t}`,command:"ngschematics.generate",arguments:[void 0,{collectionName:e.getName(),schematicName:t}]},o.iconPath=this.iconPath,o})}for(const[,t]of a.Workspace.folders)for(const[e,o]of t.collections.list)this.collections.has(e)||this.collections.set(e,o);return Array.from(this.collections.keys()).map(t=>new n.TreeItem(t,n.TreeItemCollapsibleState.Expanded))}))}}}]);
//# sourceMappingURL=extension.js.map